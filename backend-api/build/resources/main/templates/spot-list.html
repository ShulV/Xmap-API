<!DOCTYPE html>
<html lang="ru"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ulisse.it/thymeleaf-layout-dialect"
      layout:decorate="~{layout}">
<head>
    <meta charset="UTF-8">
    <title>Spots страница</title>

    <script src="https://api-maps.yandex.ru/v3/?apikey=b9ae7ce3-4f8e-4018-ae49-7751e42c5c25&lang=ru_RU"
            defer th:if="${viewMode == 'YMAP'}"></script>
    <script src="/js/lib/axios.min.js"></script>
    <script src="/js/fetch.js"></script>
    <script src="/js/location-util.js"></script>
    <script src="/js/convert-util.js"></script>
    <script src="/js/spot-filter.js" defer></script>
    <script src="/js/autocomplete.js" defer></script>
    <script src="/js/ymap.js" defer th:if="${viewMode == 'YMAP'}"></script>
    <link href="/css/spot-list-map.css" type="text/css" rel="stylesheet">
    <link href="/css/pagination.css" type="text/css" rel="stylesheet">
    <link href="/css/nav.css" type="text/css" rel="stylesheet">
    <link href="/css/filters.css" type="text/css" rel="stylesheet">
</head>
<body>
    <main layout:fragment="content" class="content">
        <div class="search-block">
<!--            <div class="search-block__search">-->
<!--                <input class="search-block__input" type="text" placeholder="Поиск"/>-->
<!--            </div>-->
            <div class="search-block__settings">
                <div class="search-block__sort">
                    <select th:if="${viewMode == 'CARDS'}"
                            class="form-select form-select-sm search-block__sort-select">
                        <option selected>Сортировка</option>
                        <option value="1">Сначала ближайшие</option>
                        <option value="2">Сначала новые</option>
                    </select>
                </div>
                <div class="search-block__filters"
                     data-bs-toggle="modal" data-bs-target="#filterModal">
                    <svg class="search-block__filters-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g id="style=stroke">
                        <g id="filter-circle">
                            <path id="vector (Stroke)" fill-rule="evenodd" clip-rule="evenodd" d="M7.75 17.5C7.75 17.0858 7.41421 16.75 7 16.75H2C1.58579 16.75 1.25 17.0858 1.25 17.5C1.25 17.9142 1.58579 18.25 2 18.25H7C7.41421 18.25 7.75 17.9142 7.75 17.5Z" fill="#000000"/>
                            <path id="vector (Stroke)_2" fill-rule="evenodd" clip-rule="evenodd" d="M16.25 6.5C16.25 6.08579 16.5858 5.75 17 5.75H22C22.4142 5.75 22.75 6.08579 22.75 6.5C22.75 6.91421 22.4142 7.25 22 7.25H17C16.5858 7.25 16.25 6.91421 16.25 6.5Z" fill="#000000"/>
                            <path id="vector (Stroke)_3" fill-rule="evenodd" clip-rule="evenodd" d="M22.75 17.5C22.75 17.0858 22.4142 16.75 22 16.75H13C12.5858 16.75 12.25 17.0858 12.25 17.5C12.25 17.9142 12.5858 18.25 13 18.25H22C22.4142 18.25 22.75 17.9142 22.75 17.5Z" fill="#000000"/>
                            <path id="vector (Stroke)_4" fill-rule="evenodd" clip-rule="evenodd" d="M1.25 6.5C1.25 6.08579 1.58579 5.75 2 5.75H11C11.4142 5.75 11.75 6.08579 11.75 6.5C11.75 6.91421 11.4142 7.25 11 7.25H2C1.58579 7.25 1.25 6.91421 1.25 6.5Z" fill="#000000"/>
                            <path id="vector (Stroke)_5" fill-rule="evenodd" clip-rule="evenodd" d="M10 15.1499C11.2426 15.1499 12.25 16.1573 12.25 17.3999C12.25 18.6425 11.2426 19.6499 10 19.6499C8.75736 19.6499 7.75 18.6425 7.75 17.3999C7.75 16.1573 8.75736 15.1499 10 15.1499ZM13.75 17.3999C13.75 15.3288 12.0711 13.6499 10 13.6499C7.92893 13.6499 6.25 15.3288 6.25 17.3999C6.25 19.471 7.92893 21.1499 10 21.1499C12.0711 21.1499 13.75 19.471 13.75 17.3999Z" fill="#000000"/>
                            <path id="vector (Stroke)_6" fill-rule="evenodd" clip-rule="evenodd" d="M14 4.1499C12.7574 4.1499 11.75 5.15726 11.75 6.3999C11.75 7.64254 12.7574 8.6499 14 8.6499C15.2426 8.6499 16.25 7.64254 16.25 6.3999C16.25 5.15726 15.2426 4.1499 14 4.1499ZM10.25 6.3999C10.25 4.32883 11.9289 2.6499 14 2.6499C16.0711 2.6499 17.75 4.32883 17.75 6.3999C17.75 8.47097 16.0711 10.1499 14 10.1499C11.9289 10.1499 10.25 8.47097 10.25 6.3999Z" fill="#000000"/>
                        </g>
                        </g>
                    </svg>
                    <span class="search-block__filters-text">Фильтры</span>
                </div>
            </div>
        </div>
        <div class="spots">
            <div class="spot__map" id="spot-map-container-id" defer th:if="${viewMode == 'YMAP'}">
                <div id="yandex-map-id" style="width: 100%; height: 100%"></div>
                <a th:href="@{'/spots?pageNumber=0&pageSize=10&viewMode=CARDS'}"
                   class="view-changing-btn">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 17H11" stroke="#000000" stroke-width="1.5" stroke-linecap="round"/>
                        <path d="M4 12L11 12" stroke="#000000" stroke-width="1.5" stroke-linecap="round"/>
                        <path d="M4 7L11 7" stroke="#000000" stroke-width="1.5" stroke-linecap="round"/>
                        <path d="M17 4L17 20M17 4L14 8M17 4L20 8M17 20L20 16M17 20L14 16" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <div class="view-changing-btn__text">список</div>
                </a>
            </div>
            <div class="spot__list-wrapper" id="spot-list-container-id" th:if="${viewMode == 'CARDS'}">
                <div class="container mt-3 mb-3">
                    <div class="row row-cols-1 g-3 spot__list"
                         th:if="${viewMode == 'CARDS'}">
                        <th:block th:each="item : ${spotList.content}">
                            <a th:href="@{/spot/{spotId}(spotId=${item.id()})}"
                               class="col card card-container shadow-sm rounded spot__item-card">
                                <div class="spot__item-img-wrapper">
                                    <img th:src="${item.firstImageLink()}" alt="spot image"
                                         class="rounded d-block spot__item-img"/>
                                </div>
                                <div class="spot__item-info">
                                    <h5 class="mt-2" th:text="${item.name()}"></h5>
                                    <div th:text="${item.getFormattedDistance()}"></div>
                                    <div class="spot__item-inserted-date"
                                         th:text="${item.insertedAt()}"></div>
                                </div>
                            </a>
                        </th:block>
                    </div>
                    <div th:if="${#lists.isEmpty(spotList.content)}">
                        Нет доступных мест.
                    </div>
                </div>
                <a th:href="@{'/spots?viewMode=YMAP'}" class="view-changing-btn">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 6H12.01M9 20L3 17V4L5 5M9 20L15 17M9 20V14M15 17L21 20V7L19 6M15 17V14M15 6.2C15 7.96731 13.5 9.4 12 11C10.5 9.4 9 7.96731 9 6.2C9 4.43269 10.3431 3 12 3C13.6569 3 15 4.43269 15 6.2Z" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <div class="view-changing-btn__text">карта</div>
                </a>
            </div>
            <!-- Добавляем навигацию по страницам -->
            <th:block th:if="${viewMode == 'CARDS'}">
                <nav th:replace="~{fragments/pagination :: paginationRow(
                                    pageable=${spotList}, paginationUrl='/spots')}">
                    place for list pagination
                </nav>
            </th:block>
        </div>
        <div th:replace="~{fragments/toast :: liveToast(
                        message='Для нескольких спотов пока недоступно, приблизьте карту', header='⚠️ Уведомление')}">
            place for toast
        </div>
        <div th:replace="~{fragments/modals/filters :: filters-modal}">
            place for filters
        </div>
    </main>
</body>
</html>